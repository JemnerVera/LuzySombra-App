SELECT * FROM MAST.USERS --> USUARIO
SELECT * FROM [mast].[origin]   --> PAIS
SELECT * FROM GROWER.GROWERS --> EMPRESA
SELECT * FROM GROWER.FARMS --> FUNDO
SELECT * FROM GROWER.STAGE --> SECTOR
SELECT * FROM GROWER.LOT --> LOTE
SELECT * FROM GROWER.PLANTATION --> UNION PLANTAS
SELECT * FROM GROWER.PLANT --> PLANTAS POR LOTE - PLANTACION
SELECT * FROM GROWER.VARIETY --> VARIEDAD - POR PLANTACION
SELECT * FROM PPP.ESTADOFENOLOGICO --> ESTADO_FEONOLOGICO
SELECT * FROM PPP.GRUPOFENOLOGICO --> GRUPO_FEONOLOGICO
SELECT * FROM GROWER.CAMPAIGN--> GRUPO_FEONOLOGICO  

SELECT VALUE AS PRODUCTID INTO #CIANAMIDA
FROM STRING_SPLIT((SELECT VALOR FROM PROPER.PARAMETROS WHERE CLAVE = 'IDS_CIANAMIDA') , ',');

SELECT A.LOTID, D.FECHAPROGRAMACION, DATEDIFF(DAY,D.FECHAPROGRAMACION,AGROAMIGO.FN_GETDATE()) DIAS, A.CAMPAIGNID FROM PPP.PROYECCION A
INNER JOIN PPP.PROYECCIONDETALLEFITOSANIDAD B WITH (NOLOCK) ON B.PROYECCIONID = A.PROYECCIONID
INNER JOIN PPP.PROGRAMACIONFITOSANIDADDETALLE C WITH (NOLOCK) ON C.PROYECCIONDETALLEFITOSANIDADID = B.PROYECCIONDETALLEFITOSANIDADID
INNER JOIN PPP.PROGRAMACION D WITH (NOLOCK) ON D.PROGRAMACIONID = C.PROGRAMACIONID
INNER JOIN PROPER.PROGRAMACIONFITOSANIDADMOVIMIENTOS E WITH (NOLOCK) ON E.PROGRAMACIONID = D.PROGRAMACIONID
WHERE LOTID = 1456 AND
B.PRODUCTID IN (SELECT PRODUCTID FROM #CIANAMIDA) AND B.FASECULTIVOID = 1

DROP TABLE #CIANAMIDA